<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Long-Term Weather Prediction - Rain-E</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #fff; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; }
        
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .back-link { color: white; text-decoration: none; font-size: 18px; }
        .back-link:hover { text-decoration: underline; }
        
        h1 { text-align: center; margin-bottom: 15px; font-size: 2.5em; }
        .subtitle { text-align: center; margin-bottom: 30px; opacity: 0.9; font-size: 1.1em; }
        
        .card { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border-radius: 20px; padding: 30px; margin-bottom: 20px; }
        
        #map { height: 400px; width: 100%; border-radius: 15px; margin-bottom: 20px; }
        
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: bold; font-size: 16px; }
        .form-group input { width: 100%; padding: 12px; border: none; border-radius: 8px; font-size: 16px; }
        .form-group small { display: block; margin-top: 5px; opacity: 0.8; }
        
        .predict-btn { width: 100%; padding: 15px; background: #4CAF50; color: white; border: none; border-radius: 10px; font-size: 18px; font-weight: bold; cursor: pointer; transition: all 0.3s; }
        .predict-btn:hover { background: #45a049; transform: translateY(-2px); }
        
        .error { background: rgba(255, 0, 0, 0.2); padding: 15px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #f44336; }
        
        .info-box { background: rgba(0, 150, 255, 0.2); padding: 20px; border-radius: 15px; margin-top: 20px; border-left: 4px solid #2196F3; }
        .info-box h3 { margin-bottom: 10px; }
        .info-box ul { margin-left: 20px; }
        .info-box li { margin-bottom: 8px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="/" class="back-link">‚Üê Back to Dashboard</a>
        </div>
        
        <h1>üîÆ Long-Term Weather Forecast</h1>
        <p class="subtitle">Predict weather up to 12 months ahead using NASA satellite data</p>
        
        {% if error %}
        <div class="error">
            <strong>‚ùå Error:</strong> {{ error }}
        </div>
        {% endif %}
        
        <div class="card">
            <h2 style="margin-bottom: 20px;">Select Location & Date</h2>
            
            <!-- Interactive Map -->
            <div id="map"></div>
            
            <form method="POST" action="/predict">
                <div class="form-group">
                    <label for="latitude">üìç Latitude</label>
                    <input type="number" id="latitude" name="latitude" step="0.0001" min="-90" max="90" value="28.6139" required>
                    <small>Click on the map or enter manually (-90 to 90)</small>
                </div>
                
                <div class="form-group">
                    <label for="longitude">üìç Longitude</label>
                    <input type="number" id="longitude" name="longitude" step="0.0001" min="-180" max="180" value="77.2090" required>
                    <small>Click on the map or enter manually (-180 to 180)</small>
                </div>
                
                <div class="form-group">
                    <label for="target_date">üìÖ Target Date</label>
                    <input type="date" id="target_date" name="target_date" required>
                    <small>Select a date up to 12 months from today</small>
                </div>
                
                <button type="submit" class="predict-btn">üöÄ Generate Prediction</button>
            </form>
        </div>
        
        <div class="info-box">
            <h3>üí° About This Feature</h3>
            <ul>
                <li><strong>AI-Powered:</strong> Uses machine learning model trained on NASA Earth observation data</li>
                <li><strong>12-Month Range:</strong> Predict weather conditions for any location up to 1 year ahead</li>
                <li><strong>Event Planning:</strong> Perfect for weddings, outdoor events, vacations, or agricultural planning</li>
                <li><strong>Probability-Based:</strong> Get rain, snow, temperature, and extreme weather probabilities</li>
            </ul>
        </div>
    </div>
    
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Initialize map
        const map = L.map('map').setView([28.6139, 77.2090], 5);
        
        // Add OpenStreetMap tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '¬© OpenStreetMap contributors'
        }).addTo(map);
        
        // Add marker
        let marker = L.marker([28.6139, 77.2090], {draggable: true}).addTo(map);
        
        // Update coordinates when marker is dragged
        marker.on('dragend', function(e) {
            const pos = marker.getLatLng();
            document.getElementById('latitude').value = pos.lat.toFixed(4);
            document.getElementById('longitude').value = pos.lng.toFixed(4);
        });
        
        // Update marker when clicking on map
        map.on('click', function(e) {
            marker.setLatLng(e.latlng);
            document.getElementById('latitude').value = e.latlng.lat.toFixed(4);
            document.getElementById('longitude').value = e.latlng.lng.toFixed(4);
        });
        
        // Update marker when coordinates are manually entered
        document.getElementById('latitude').addEventListener('input', updateMarker);
        document.getElementById('longitude').addEventListener('input', updateMarker);
        
        function updateMarker() {
            const lat = parseFloat(document.getElementById('latitude').value);
            const lon = parseFloat(document.getElementById('longitude').value);
            if (!isNaN(lat) && !isNaN(lon)) {
                marker.setLatLng([lat, lon]);
                map.setView([lat, lon], map.getZoom());
            }
        }
        
        // Set min/max date (today to 1 year from now)
        const today = new Date();
        const maxDate = new Date();
        maxDate.setFullYear(maxDate.getFullYear() + 1);
        
        document.getElementById('target_date').min = today.toISOString().split('T')[0];
        document.getElementById('target_date').max = maxDate.toISOString().split('T')[0];
        
        // Set default to 30 days from now
        const defaultDate = new Date();
        defaultDate.setDate(defaultDate.getDate() + 30);
        document.getElementById('target_date').value = defaultDate.toISOString().split('T')[0];
    </script>
</body>
</html>
